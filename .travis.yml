os: osx
osx_image: xcode7.3

cache:
  directories:
  - $HOME/.macports-ci-ccache

script:
- curl -LO https://raw.githubusercontent.com/GiovanniBussi/macports-ci/master/macports-ci
- source ./macports-ci install
- source macports-ci ccache --save
- port install autoconf213 libidl clang-10 node cmake gnu-tar python nasm yasm
- curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --default-toolchain 1.45.1-x86_64-apple-darwin
- export PATH=$PATH:~/.cargo/bin
- cargo install sccache
- ./mach build
- ./mach package
